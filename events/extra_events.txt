add_namespace = randev
add_namespace = randnews
add_namespace = onactev
add_namespace = debugmod
add_namespace = mechanics

country_event = { # YOU ARE FORCED TO EMBARGO
	id = mechanics.1
	title = mechanics.1.t
	desc = mechanics.1.d

	is_triggered_only = yes

	option = {
		name = mechanics.1.a

		if = {
			limit = {
				is_major = yes
			}
			add_threat = 2
		}
		add_to_array = {embargoList = from_fembargo_country}
		add_to_array = {forcedEmbargoList = from_fembargo_country}
		var:from_fembargo_country = {
			country_event = {id = onactev.2 days = 1}
		}

		FROM = {
			country_event = {id = mechanics.3 days = 1}
		}

		#var:from_fembargo_country = {annex_country = {target = PREV}}
		ai_chance = {
			base = 50
			modifier = {
				set_temp_variable = {razn = FROM.world_influence}
				divide_temp_variable = {razn = world_influence}
				check_variable = {razn > 2.9}
				add = 50
			}
			modifier = {
				set_temp_variable = {razn = FROM.world_influence}
				divide_temp_variable = {razn = world_influence}
				check_variable = {razn > 3.9}
				add = 50
			}
			modifier = {
				set_temp_variable = {razn = FROM.world_influence}
				divide_temp_variable = {razn = world_influence}
				check_variable = {razn > 4.9}
				add = 100
			}
		}
	}
	option = {
		name = mechanics.1.b


		set_temp_variable = {razn = FROM.world_influence}
		divide_temp_variable = {razn = world_influence}

		if = {
			limit = {check_variable = {razn > 4.9}}
			add_political_power = -200
		}
		else_if = {
			limit = {check_variable = {razn > 3.9}}
			add_political_power = -150	
		}
		else_if = {
			limit = {check_variable = {razn > 2.9}}
			add_political_power = -100
		}
		else = {
			add_political_power = -50	
		}

		ai_chance = {
			base = 100
		}
	}
}

country_event = { # YOU ARE FORCED TO CANCEL GUARANTEE
	id = mechanics.2
	title = mechanics.2.t
	desc = mechanics.2.d

	is_triggered_only = yes

	option = {
		name = mechanics.2.a

		diplomatic_relation = {
		    country = FROM
		    relation = guarantee
		    active = no
		}

		ai_chance = {
			base = 50
			modifier = {
				set_temp_variable = {razn = FROM.world_influence}
				divide_temp_variable = {razn = world_influence}
				check_variable = {razn > 3.9}
				add = 50
			}
			modifier = {
				set_temp_variable = {razn = FROM.world_influence}
				divide_temp_variable = {razn = world_influence}
				check_variable = {razn > 4.9}
				add = 100
			}
		}
	}
	option = {
		name = mechanics.2.b


		set_temp_variable = {razn = FROM.world_influence}
		divide_temp_variable = {razn = world_influence}

		if = {
			limit = {check_variable = {razn > 4.9}}
			add_political_power = -200
		}
		else_if = {
			limit = {check_variable = {razn > 3.9}}
			add_political_power = -150	
		}
		else = {
			add_political_power = -50	
		}

		ai_chance = {
			base = 100
		}
	}
}

country_event = { # SOMEONE ACCEPTED FORCED EMBARGO
	id = mechanics.3
	title = mechanics.3.t
	desc = mechanics.3.d

	is_triggered_only = yes

	option = {
		name = mechanics.3.a
	}
}

country_event = {
	id = debugmod.1
	is_triggered_only = yes
	option = {
		name = debugmod.1.a
		every_country = {
			set_country_flag = debug_nuke_mod
		}
	}
}

country_event = {#Аншлюз
	id = onactev.1
	title = onactev.1.t
	desc = onactev.1.d

	is_triggered_only = yes

	option = {
		name = onactev.1.a
		#nothing
		ai_chance = {
			factor = 20
		}
	}
	option = {
		name = onactev.1.b
		FROM = {
			annex_country = {
				target = ROOT
				transfer_troops = yes
			}
		}
		ai_chance = {
			factor = 80
		}
	}
}

country_event = {
	id = onactev.2
	title = onactev.2.t
	desc = onactev.2.d

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			every_country = {
				limit = {is_subject_of = FROM}

				add_opinion_modifier = {
					target = ROOT
					modifier = embargo_bitch
				}
			}

			add_opinion_modifier = {
				target = FROM
				modifier = embargo_initiator
			}
			FROM = {
				add_opinion_modifier = {
					target = ROOT
					modifier = embargo_bitch
				}
				add_opinion_modifier = {
					target = ROOT
					modifier = embargo_target
				}
			}
		}
	}
	option = {
		name = onactev.2.a
	}
}

country_event = {
	id = onactev.3
	title = onactev.3.t
	desc = onactev.3.d

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			every_country = {
				limit = {is_subject_of = FROM}

				remove_opinion_modifier = {
					target = ROOT
					modifier = embargo_bitch
				}
			}

			remove_opinion_modifier = {
				target = FROM
				modifier = embargo_initiator
			}
			FROM = {
				remove_opinion_modifier = {
					target = ROOT
					modifier = embargo_bitch
				}
				remove_opinion_modifier = {
					target = ROOT
					modifier = embargo_target
				}
			}
		}
	}
	option = {
		name = onactev.3.a
	}
}

#country_event = {	# Митинги у монархов вход 
#	id = randev.1
#
#	hidden = yes
#
#	mean_time_to_happen = {
#		days = 120
#		modifier = {
#			factor = 2
#			OR = {
#				tag = ORB
#				tag = SBU
#				tag = SFL
#			}
#		}
#		modifier = {
#			factor = 0.5
#			has_war = yes
#		}
#	}
#
#	trigger = {
#		has_civil_war = no
#		has_government = monarchism
#		not = {has_country_flag = MonarchyMeetingsFired}
#	}
#
#	immediate = {
#		random_list = {
#			40 = {
#				set_country_flag = MonarchyMeetingsFired
#				country_event = {id = randev.2}
#			}
#			60 = {
#				#nothing
#			}
#		}
#	}
#	option = {name = randev.1.a}
#}

country_event = {
	id = randev.2
	title = randev.2.t
	desc = randev.2.desc

	is_triggered_only = yes

	option = {
		name = randev.2.a #игнор
		custom_effect_tooltip = unknown_effect_tooltip
		hidden_effect = {
			random_list = {
				10 = {#Митинги прошли сами
					country_event = {id = randev.4 days=7} 
					modifier = {
						factor = 4
						OR = {
							has_political_power > 200
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 4}
							}
							has_stability > 0.8
						}
					}
				}
				10 = {#Люди разошлись но будет хуже
					country_event = {id = randev.5 days = 30} 
					modifier = {
						factor = 3
						OR = {
							has_political_power > 100
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 2.5}
							}
							has_stability > 0.6
						}
					}
				}
				2 = {#Вооруженное восстание
					country_event = {id = randev.6 days = 120}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 10
						has_idea = elite_supporting
					}
					modifier = {
						factor = 0.1
						has_idea = workers_supporting
					}
				}
				5 = {#Вынужденный отказ от престола
					country_event = {id = randev.7 days = 30}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 3
						has_political_power < 0
					}
					modifier = {
						factor = 10
						has_idea = workers_supporting
					}
					modifier = {
						factor = 0.1
						has_idea = elite_supporting
					}
				}
			}
		}
	}
	option = {
		name = randev.2.b #экономич. задобрить
		add_ideas = less_workday
		custom_effect_tooltip = unknown_effect_tooltip
		hidden_effect = {
			random_list = {
				30 = {#Митинги прошли сами
					country_event = {id = randev.4 days=7} 
					modifier = {
						factor = 4
						OR = {
							has_political_power > 200
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 4}
							}
							has_stability > 0.8
						}
					}
				}
				40 = {#Люди разошлись но будет хуже
					country_event = {id = randev.5 days = 30} 
					modifier = {
						factor = 3
						OR = {
							has_political_power > 100
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 2.5}
							}
							has_stability > 0.6
						}
					}
				}
				5 = {#Вооруженное восстание
					country_event = {id = randev.6 days = 120}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 0.1
						has_idea = workers_supporting
					}
					modifier = {
						factor = 10
						has_idea = elite_supporting
					}
				}
				25 = {#Вынужденный отказ от престола
					country_event = {id = randev.7 days = 30}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 3
						has_political_power < 0
					}
					modifier = {
						factor = 10
						has_idea = workers_supporting
					}
					modifier = {
						factor = 0.1
						has_idea = elite_supporting
					}
				}
			}
		}
	}
	option = {
		name = randev.2.c #полит. задобрить
		add_political_power = -50
		custom_effect_tooltip = unknown_effect_tooltip
		hidden_effect = {
			random_list = {
				10 = {#Митинги прошли сами
					country_event = {id = randev.4 days=7} 
					modifier = {
						factor = 4
						OR = {
							has_political_power > 200
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 4}
							}
							has_stability > 0.8
						}
					}
				}
				15 = {#Люди разошлись но будет хуже
					country_event = {id = randev.5 days = 30} 
					modifier = {
						factor = 3
						OR = {
							has_political_power > 100
							AND = {
								has_political_power > 0
								check_variable = {world_influence > 2.5}
							}
							has_stability > 0.6
						}
					}
				}
				5 = {#Вооруженное восстание
					country_event = {id = randev.6 days = 120}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 0.1
						has_idea = workers_supporting
					}
					modifier = {
						factor = 10
						has_idea = elite_supporting
					}
				}
				7 = {#Вынужденный отказ от престола
					country_event = {id = randev.7 days = 30}
					modifier = {
						factor = 100
						has_stability < 0.3
						has_war = yes
						has_war_support < 0.6
					}
					modifier = {
						factor = 3
						has_political_power < 0
					}
					modifier = {
						factor = 10
						has_idea = workers_supporting
					}
					modifier = {
						factor = 0.1
						has_idea = elite_supporting
					}
				}
			}
		}
	}
	option = {
		name = randev.2.z
		custom_effect_tooltip = show_other_options_tooltip
		hidden_effect = {
			country_event = {id = randev.3}
		}
	}
}

country_event = {
	id = randev.3
	title = randev.2.t
	desc = randev.2.desc

	is_triggered_only = yes

	option = {
		name = randev.2.d #конституция
		news_event = {id = randnews.1}
		set_politics = {
			ruling_party = democratic
			elections_allowed = yes
		}
		add_popularity = {
			ideology = democratic
			popularity = 0.2
		}
		set_cosmetic_tag = original_tag@monarchism
	}
	option = {
		name = randev.2.e #аресты
	}
	option = {
		name = randev.2.f #РЕЗНЯ
		add_manpower = -10000
		add_command_power = -90
		set_stability = 0
		set_political_power = 50
		custom_effect_tooltip = unknown_effect_tooltip
		hidden_effect = {
			random_list = {
				50 = {#Вооруженное восстание
					country_event = {id = randev.6 days = 1}
				}
				50 = {#Сопротивление подавленно
					country_event = {id = randev.8 days = 14}
				}
			}
		}
	}	
	option = {
		name = randev.2.z
		custom_effect_tooltip = show_other_options_tooltip
		hidden_effect = {
			country_event = {id = randev.2}
		}
	}
}

country_event = {
	id = randev.4
	title = randev.4.t
	desc = randev.4.d

	is_triggered_only = yes

	option = {
		name = randev.4.a
	}
}

country_event = {
	id = randev.5
	title = randev.5.t
	desc = randev.5.d

	is_triggered_only = yes
	hidden = yes

	immediate = {
		random_list = {
			2 = {#Вооруженное восстание
				country_event = {id = randev.6 days = 120}
				modifier = {
					factor = 100
					has_stability < 0.3
					has_war = yes
					has_war_support < 0.6
				}
				modifier = {
						factor = 0.1
						has_idea = workers_supporting
					}
					modifier = {
						factor = 10
						has_idea = elite_supporting
					}
			}
			2 = {#Вынужденный отказ от престола
				country_event = {id = randev.7 days = 30}
				modifier = {
					factor = 100
					has_stability < 0.3
					has_war = yes
					has_war_support < 0.6
				}
				modifier = {
					factor = 3
					has_political_power < 0
				}
				modifier = {
						factor = 10
						has_idea = workers_supporting
					}
					modifier = {
						factor = 0.1
						has_idea = elite_supporting
					}
			}
		}
	}
}

country_event = {
	id = randev.6
	title = randev.6.t
	desc = randev.6.d

	is_triggered_only = yes

	option = {
		name = randev.6.a
		custom_effect_tooltip = defend_monarchy_tooltip
		hidden_effect = {
			start_civil_war = {
				ruling_party = monarchism
				ideology = democratic
				size = 0.2
				only_own_territory = yes
			}
		}
	}
	option = {
		name = randev.6.b
		custom_effect_tooltip = attack_for_dem_tooltip
		hidden_effect = {
			start_civil_war = {
				ruling_party = democratic
				ideology = monarchism
				size = 0.8
				only_own_territory = no
			}
		}
	}
}

country_event = {
	id = randev.7
	title = randev.7.t
	desc = randev.7.d

	is_triggered_only = yes

	immediate = {
		hidden_effect = {retire_country_leader = yes}
	}

	option = {
		name = randev.7.a
	}
	option = {
		name = randev.7.b
	}
}

country_event = {
	id = randev.8
	title = randev.8.t
	desc = randev.8.d

	is_triggered_only = yes

	option = {
		name = randev.8.a
	}
}

country_event = {
	id = randev.9

	hidden = yes

	trigger = {
		has_civil_war = no
		has_government = monarchism
	}

	mean_time_to_happen = {
		days = 360
		modifier = {
			factor = 1
			always = yes
		}
	}

	immediate = {
		random_list = {
			5 = {
				country_event = {id = randev.10}
			}
			95 = {
				#nothing
			}
		}
	}
	option = {name = randev.9.a}
}

country_event = {
	id = randev.10
	title = randev.10.t
	desc = randev.10.d

	is_triggered_only = yes

	immediate = {hidden_effect = {kill_country_leader = yes}}
	option = {
		name = randev.10.a
	}
}

news_event = { #Конституция
	id = randnews.1
	title = randnews.1.t
	desc = randnews.1.d

	is_triggered_only = yes

	major = yes

	option = {
		name = randnews.1.a
	}
}